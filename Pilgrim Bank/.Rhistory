svm_par=tune.svm(as.factor(Retain) ~ Profit9+Online9+AgeZero+AgeGiven+IncomeZero
+IncomeGiven+Tenure+District1100+District1200,
data=df.train, kernel="linear", gamma=10^g, cost=10^c,
scale=TRUE)
summary(svm_par)
svm_model=svm(as.factor(Retain) ~ Profit9+Online9+AgeZero+AgeGiven+IncomeZero+IncomeGiven
+Tenure+District1100+District1200, data = df.train, kernel = "linear",
cost = 10, gamma=1e-05, scale = TRUE)
svm_pred=predict(svm_model, df.test)
cf = confusionMatrix(data = svm_pred, reference = target.under.test, mode = "prec_recall")
cf
specificity=specificity(svm_pred,target.under.test, positive="1")
cat('Specificity:',specificity, '\n')
library(pROC)
treeROC = roc(target.test,factor(tree.pred, ordered = TRUE), plot=TRUE, print.auc=TRUE,
col="blue")
logit_roc=plot.roc(target.test, factor(logit.pred, ordered = TRUE), add=TRUE,
col="green", print.auc=TRUE, print.auc.y=0.3)
knn_roc = plot.roc(target.test,factor(knn_pred, ordered = TRUE), add=TRUE,
col="red", print.auc=TRUE, print.auc.y=0.7, print.auc.x=0.2)
svm_roc = plot.roc(target.under.test,factor(svm_pred, ordered = TRUE), add=TRUE,
col="magenta", print.auc=TRUE, print.auc.y=0.9, print.auc.x=0.1)
legend("bottomleft", legend = c("Logistic Regression", "Decision Tree", "KNN", "Svm"),
col=c("green", "blue", "red", "magenta"), pch=15, cex=0.4)
detach(data)
newdata = data[Online9==0 & Retain==1,]
attach(newdata)
Profit9=X9Profit
Profit0=X0Profit
Online0=X0Online
District=X9District
District1100 = ifelse(District==1100,1,0)
District1200 = ifelse(District==1200,1,0)
Age=X9Age
Age1 = ifelse(Age==1&!is.na(Age),1,0)
Age2 = ifelse(Age==2&!is.na(Age),1,0)
Age3 = ifelse(Age==3&!is.na(Age),1,0)
Age4 = ifelse(Age==4&!is.na(Age),1,0)
Age5 = ifelse(Age==5&!is.na(Age),1,0)
Age6 = ifelse(Age==6&!is.na(Age),1,0)
Age7 = ifelse(Age==7&!is.na(Age),1,0)
Income=X9Inc
Income1 = ifelse(Income==1&!is.na(Income),1,0)
Income2 = ifelse(Income==2&!is.na(Income),1,0)
Income3 = ifelse(Income==3&!is.na(Income),1,0)
Income4 = ifelse(Income==4&!is.na(Income),1,0)
Income5 = ifelse(Income==5&!is.na(Income),1,0)
Income6 = ifelse(Income==6&!is.na(Income),1,0)
Income7 = ifelse(Income==7&!is.na(Income),1,0)
Income8 = ifelse(Income==8&!is.na(Income),1,0)
Income9 = ifelse(Income==9&!is.na(Income),1,0)
Tenure=X9Tenure
Tenure1 = ifelse(Tenure<10,1,0)
Tenure2 = ifelse(Tenure>=10&Tenure<20,1,0)
Tenure3 = ifelse(Tenure>=20&Tenure<30,1,0)
Tenure4 = ifelse(Tenure>=30&Tenure<40,1,0)
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9, Tenure1, Tenure2, Tenure3, Tenure4, District1100, District1200)
k2 <- kmeans(df, centers = 20, nstart = 25)
deltaProfit = Profit0-Profit9
for(num_cluster in 1:20) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
print(deltaProfitOnline-deltaProfitOffline)
#}
}
rep(0,20)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,20)
for(num_cluster in 1:20) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff))
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,20)
for(num_cluster in 1:20) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
num_tot_cluster = 20
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9, Tenure1, Tenure2, Tenure3, Tenure4, District1100, District1200)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 20
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9, Tenure1, Tenure2, Tenure3, Tenure4, District1100, District1200)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 20
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9, Tenure1, Tenure2, Tenure3, Tenure4, District1100, District1200)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 25
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9, Tenure1, Tenure2, Tenure3, Tenure4, District1100, District1200)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 25
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 20
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 25
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 15
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 10
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 30
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 25
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 25
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7)#, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
set.seed(1)
num_tot_cluster = 7
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7)#, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 6
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7)#, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
set.seed(1)
num_tot_cluster = 25
df = data.frame(Age1, Age2, Age3, Age4, Age5, Age6, Age7, Income1, Income2, Income3, Income4, Income5, Income6, Income7, Income8, Income9)
k2 <- kmeans(df, centers = num_tot_cluster, nstart = 25)
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
#print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
#print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
#print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
print(paste("deltaProfit online ",deltaProfitOnline))
print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)))#/sum(k2$cluster==num_cluster))
print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)/sum(k2$cluster==num_cluster))
print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
print(paste("Tot in cluster:", sum(k2$cluster==num_cluster)))
print(paste("Offline in cluster",sum(Online0[k2$cluster==num_cluster]==0)/sum(k2$cluster==num_cluster)))
print(paste("Online in cluster",sum(Online0[k2$cluster==num_cluster]==1)))
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
#print(paste("deltaProfit online ",deltaProfitOnline))
#print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
print(paste("deltaProfit online ",deltaProfitOnline))
print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
deltaProfit = Profit0-Profit9
deltaOnOff = rep(0,num_tot_cluster)
for(num_cluster in 1:num_tot_cluster) {
deltaProfitOnline  = mean(deltaProfit[Online0[k2$cluster==num_cluster]==1])
deltaProfitOffline = mean(deltaProfit[Online0[k2$cluster==num_cluster]==0])
if(is.na(deltaProfitOnline)){deltaProfitOnline=0}
if(is.na(deltaProfitOffline)){deltaProfitOffline=0}
#print(paste("Perc di Online con profitto positivo" ,mean(deltaProfit[Online0[k2$cluster==num_cluster]==1]>0)))
print(paste("deltaProfit online ",deltaProfitOnline))
print(paste("deltaProfit offline",deltaProfitOffline))
#if(deltaProfitOnline-deltaProfitOffline>0){
deltaOnOff[num_cluster] = deltaProfitOnline-deltaProfitOffline
#}
}
print(sort(deltaOnOff, decreasing = TRUE))
